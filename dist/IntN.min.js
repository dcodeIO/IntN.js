/*
 IntN.js (c) 2014 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/IntN.js for details
*/
(function(p){function n(m){function b(a,b){this.bytes=Array(f);for(var d=0,e=a.length;d<e;++d)this.bytes[d]=a[d]&255;for(;d<f;++d)this.bytes[d]=0;this.unsigned=!!b}if(0>=m||0!==m%8)throw Error("Illegal number of bits: "+m+" (not a positive multiple of 8)");b.BITS=m|0;var f=m/8|0;b.BYTES=f;var k=f-1,q=Array(f);(function(){for(var a=0;a<f;++a)q[a]=0})();var n=Array(f);(function(){for(var a=0;a<f;++a)n[a]=255})();b.isIntN=function(a){return!0===(a&&Array.isArray(a.bytes)&&a.bytes.length===f&&"boolean"===
typeof a.unsigned)};b.valueOf=function(a){return"number"===typeof a?b.fromNumber(a):"string"===typeof a?b.fromString(a):a&&a instanceof b&&a.bytes.length==f?a:new b(a.bytes,a.unsigned)};b.prototype.cast=function(a,b){b="boolean"===typeof b?b:this.unsigned;var d=this.isNegative(),e=d?this.negate():this,e=new a(e.bytes,b);return d?e.negate():e};b.ZERO=new b([],!1);b.UZERO=new b([],!0);b.ONE=new b([1],!1);b.UONE=new b([1],!0);b.MIN_VALUE=new b(q.slice(0,f));b.MIN_VALUE.bytes[k]|=128;b.MAX_VALUE=new b(n.slice(0,
f));b.MAX_VALUE.bytes[k]&=127;b.MAX_UNSIGNED_VALUE=new b(n.slice(0,f),!0);b.prototype.isSigned=function(){return!this.unsigned};b.prototype.isUnsigned=function(){return this.unsigned};b.prototype.toSigned=function(){return this.unsigned?new b(this.bytes,!1):this};b.prototype.toUnsigned=function(){return this.unsigned?this:new b(this.bytes,!0)};b.prototype.isNegative=function(){return!this.unsigned&&128===(this.bytes[k]&128)};b.prototype.isPositive=function(){return this.unsigned||0===(this.bytes[k]&
128)};b.prototype.isEven=function(){return 0===(this.bytes[0]&1)};b.prototype.isOdd=function(){return 1===(this.bytes[0]&1)};b.prototype.isZero=function(){for(var a=0;a<f;++a)if(0!==this.bytes[a])return!1;return!0};b.prototype.compare=function(a){b.isIntN(a)||(a=b.valueOf(a));if(this.isNegative()&&!a.isNegative())return-1;if(!this.isNegative()&&a.isNegative())return 1;for(var c=k;0<=c;--c){if(this.bytes[c]<a.bytes[c])return-1;if(this.bytes[c]>a.bytes[c])return 1}return 0};b.prototype.equals=function(a){return 0===
this.compare(a)};b.prototype.notEquals=function(a){return 0!==this.compare(a)};b.prototype.lessThan=function(a){return-1===this.compare(a)};b.prototype.lessThanEqual=function(a){return 0>=this.compare(a)};b.prototype.greaterThan=function(a){return 1===this.compare(a)};b.prototype.greaterThanEqual=function(a){return 0<=this.compare(a)};b.fromInt=function(a,c){a|=0;if(0>a)return a===b.MIN_VALUE.toInt()?b.MIN_VALUE:b.fromInt(-a,c).negate();for(var d=Array(f),e=0;e<f;++e)d[e]=a>>>8*e&255;return new b(d,
c)};b.prototype.toInt=function(){var a=this.isNegative(),b=this;a&&(b=b.not());for(var d=0,e=0;d<Math.min(4,b.bytes.length);++d)e|=b.bytes[d]<<8*d;a&&(e=~e);return this.unsigned?e>>>0:e};b.fromNumber=function(a,c){if("number"!==typeof a)throw TypeError("illegal arguments: "+typeof a);if(a!==a||!isFinite(a)||0===a)return c?b.UZERO:b.ZERO;if(0>a)return b.fromNumber(-a,c).negate();for(var d=0,e=Array(f);d<f;++d)e[d]=a%256&255,a=Math.floor(a/256);return new b(e,c)};b.prototype.toNumber=function(){if(this.isZero())return 0;
if(this.isNegative())return this.equals(b.MIN_VALUE)?-2147483648:-this.negate().toNumber();for(var a=0,c=0,d=Math.min(f,7);a<d;++a)c+=this.bytes[a]<<8*a>>>0;return c};b.prototype.not=function(){for(var a=0,c=Array(f);a<f;++a)c[a]=~this.bytes[a];return new b(c,this.unsigned)};b.prototype.and=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var c=0,d=Array(f);c<f;++c)d[c]=this.bytes[c]&a.bytes[c];return new b(d,this.unsigned)};b.prototype.or=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var c=0,d=Array(f);c<
f;++c)d[c]=this.bytes[c]|a.bytes[c];return new b(d,this.unsigned)};b.prototype.xor=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var c=0,d=Array(f);c<f;++c)d[c]=this.bytes[c]^a.bytes[c];return new b(d,this.unsigned)};b.prototype.shiftLeft=function(a){b.isIntN(a)&&(a=a.toInt());a&=m-1;if(0===a)return this;var c=a/8|0;a%=8;for(var d=0,e=q.slice(0,f),g;d<f&&!((g=d+c)>=f);++d)e[g]|=this.bytes[d]<<a&255,++g<f&&(e[g]|=this.bytes[d]<<a>>>8&255);return new b(e,this.unsigned)};b.prototype.shiftRight=function(a,
c){b.isIntN(a)&&(a=a.toInt());a&=m-1;if(0===a)return this;var d=a/8|0;a%=8;var e=q.slice(0,f),g;if(!c&&128===(this.bytes[k]&128)){var l;g=f-1;for(l=f-d-1;g>=l;--g)e[g]=255;e[++g]=e[g]<<7-a&255}var h;for(g=0;g<f;++g)0<=(h=g-d)&&(e[h]|=this.bytes[g]>>>a&255),0<=--h&&(e[h]|=this.bytes[g]<<8>>>a&255);return new b(e,this.unsigned)};b.prototype.shiftRightUnsigned=function(a){return this.shiftRight(a,!0)};b.prototype.add=function(a){b.isIntN(a)||(a=b.valueOf(a));if(a.isZero())return this;if(this.isZero())return this.unsigned?
a.toUnsigned():a.toSigned();var c=this.and(a);a=this.xor(a);for(var d;!c.isZero();)d=c.shiftLeft(1),c=a.and(d),a=a.xor(d);return a};b.prototype.negate=function(){return this.not().add(b.ONE)};b.NEG_ONE=b.ONE.negate();b.prototype.subtract=function(a){b.isIntN(a)||(a=b.valueOf(a));return this.add(a.negate())};b.prototype.absolute=function(){return this.unsigned?this:(this.isNegative()?this.negate():this).toUnsigned()};b.prototype.multiply=function(a){b.isIntN(a)||(a=b.valueOf(a));if(this.isZero())return this;
var c=this.isNegative()!==a.isNegative(),d=this.absolute();a=a.absolute();for(var e=this.unsigned?b.UZERO:b.ZERO;!a.isZero();d=d.shiftLeft(1),a=a.shiftRight(1,!0))1===(a.bytes[0]&1)&&(e=e.add(d));return c?e.negate():e};b.divide=function(a,c){if(c.isZero())throw Error("division by zero");if(a.isZero())return{quotient:a.unsigned?b.UZERO:b.ZERO,remainder:a};for(var d=a.isNegative()!==c.isNegative(),e=a.unsigned?b.UZERO:b.ZERO,f=a.absolute(),l=c.absolute(),h=b.UONE,k=b.MIN_VALUE.toUnsigned();h.lessThan(k)&&
l.lessThan(f);)l=l.shiftLeft(1),h=h.shiftLeft(1);for(;h.greaterThanEqual(b.UONE);)l.lessThanEqual(f)&&(e=e.add(h),f=f.subtract(l)),l=l.shiftRight(1,!0),h=h.shiftRight(1,!0);return{quotient:d?e.negate():e,remainder:f}};b.prototype.divide=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.divide(this,a).quotient};b.prototype.modulo=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.divide(this,a).remainder};b.prototype.toDebug=function(a){for(var b=k,d="";0<=b;--b){for(var e=this.bytes[b].toString(2);8>
e.length;)e="0"+e;d+=e;a&&0<b&&(d+=" ")}this.unsigned&&(d+=a?" U":"U");return d};b.fromString=function(a,c,d){"number"===typeof c&&(d=c,c=!1);a=(a+"").toLowerCase();d=d||10;if(2>d||36<d)throw RangeError("radix out of range: "+d+" (2-36)");if("-"===a.charAt(0))return b.fromString(a.substring(1),c,d).negate();"+"===a.charAt(0)&&(a=a.substring(1));if("0"===a||"NaN"===a||"Infinity"===a)return c?b.UZERO:b.ZERO;c=c?b.UZERO:b.ZERO;for(var e=2===d?function(a){return 1<<a}:Math.pow.bind(Math,d),f=0,l=a.length,
h,k;f<l;++f){h=a.charAt(l-f-1);k="0123456789abcdefghijklmnopqrstuvwxyz".indexOf(h);if(0>k||k>d)throw Error("illegal interior character: "+h);c=c.add(b.fromInt(k).multiply(b.fromInt(e(f))))}return c};var p=b.fromInt(2),t=b.fromInt(36);b.prototype.toString=function(a){a=a||10;b.isIntN(a)||(a=b.valueOf(a));if(a.lessThan(p)||a.greaterThan(t))throw RangeError("radix out of range: "+a.toInt()+" (2-36)");var c=this.unsigned?b.UZERO:b.ZERO;if(this.equals(c))return"0";if(this.isNegative()){if(this.equals(b.MIN_VALUE)){var c=
b.divide(this,a).quotient,d=c.multiply(a).subtract(this);return c.toString(a)+d.toInt().toString(a.toInt())}return"-"+this.negate().toString(a)}var d=this,e=[],f;do f=d.modulo(a),e.unshift("0123456789abcdefghijklmnopqrstuvwxyz".charAt(f.toInt())),d=b.divide(d,a).quotient;while(!d.equals(c));return e.join("")};var r={isIntN:["isInt"+m]},s={compare:["comp"],equals:["eq","equal","=="],notEquals:["ne","notEqual","!="],lessThan:["lt","less","lesser","<"],lessThanEqual:["lte","lessThanOrEqual","<="],greaterThan:["gt",
"greater",">"],greaterThanEqual:["gte","greaterThanOrEqual",">="],not:["~"],and:["&"],or:["|"],xor:["^"],shiftLeft:["lsh","leftShift","<<"],shiftRight:["rsh","rightShift",">>"],shiftRightUnsigned:["rshu","rightShiftUnsigned",">>>"],add:["plus","+"],negate:["neg","!"],subtract:["sub","minus","-"],absolute:["abs","||"],multiply:["mult","*"],divide:["div","/"],modulo:["mod","%"]};(function(){var a,c;for(a in r)if(r.hasOwnProperty(a))for(c=0;c<r[a].length;++c)b[r[a][c]]=b[a];for(a in s)if(s.hasOwnProperty(a))for(c=
0;c<s[a].length;++c)b.prototype[s[a][c]]=b.prototype[a]})();return b}"undefined"!==typeof module&&module.exports?module.exports=n:"function"===typeof define&&define.amd?define(function(){return n}):(p.dcodeIO=p.dcodeIO||{}).IntN=n})(this);
