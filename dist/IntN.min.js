/*
 IntN.js (c) 2014 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/IntN.js for details
*/
(function(t){var q=function(){var q={},t=[1,256,65536,16777216,4294967296,1099511627776,281474976710656],r={compare:["comp"],equals:["eq","equal","=="],notEquals:["ne","notEqual","!="],lessThan:["lt","less","lesser","<"],lessThanEqual:["lte","lessThanOrEqual","<="],greaterThan:["gt","greater",">"],greaterThanEqual:["gte","greaterThanOrEqual",">="],not:["~"],and:["&"],or:["|"],xor:["^"],shiftLeft:["lsh","leftShift","<<"],shiftRight:["rsh","rightShift",">>"],shiftRightUnsigned:["rshu","rightShiftUnsigned",
">>>"],add:["plus","+"],negate:["neg","!"],subtract:["sub","minus","-"],absolute:["abs","||"],multiply:["mult","*"],divide:["div","/"],modulo:["mod","%"]};return function(m){function b(a,b){this.bytes=Array(e);for(var c=0,f=Math.min(e,a.length);c<f;++c)this.bytes[c]=a[c]&255;for(;c<e;++c)this.bytes[c]=0;this.unsigned=!!b}if(0>=m||0!==m%8)throw Error("illegal number of bits: "+m+" (not a positive multiple of 8)");if(q[m])return q[m];for(var e=m/8|0,n=e-1,s=Array(e),h=0;h<e;++h)s[h]=0;for(var u=Array(e),
h=0;h<e;++h)u[h]=255;b.BITS=m|0;b.BYTES=e;b.isIntN=function(a){return!0===(a&&Array.isArray(a.bytes)&&a.bytes.length===e&&"boolean"===typeof a.unsigned)};b.valueOf=function(a){return"number"===typeof a?b.fromNumber(a):"string"===typeof a?b.fromString(a):a&&a instanceof b&&a.bytes.length===e?a:a&&"number"===typeof a.b&&"number"===typeof a.a&&"boolean"===typeof a.unsigned?b.fromInts([a.b,a.a],a.unsigned):new b(a.bytes,a.unsigned)};b.prototype.cast=function(a,b){b="boolean"===typeof b?b:this.unsigned;
var c=this.isNegative(),f=c?this.not():this,f=new a(f.bytes,b);return c?f.not():f};b.ZERO=new b([],!1);b.UZERO=new b([],!0);b.ONE=new b([1],!1);b.UONE=new b([1],!0);b.MIN_VALUE=new b(s.slice(0,e));b.MIN_VALUE.bytes[n]|=128;b.MAX_VALUE=new b(u.slice(0,e));b.MAX_VALUE.bytes[n]&=127;b.MAX_UNSIGNED_VALUE=new b(u.slice(0,e),!0);b.prototype.isSigned=function(){return!this.unsigned};b.prototype.isUnsigned=function(){return this.unsigned};b.prototype.toSigned=function(){return this.unsigned?new b(this.bytes,
!1):this};b.prototype.toUnsigned=function(){return this.unsigned?this:new b(this.bytes,!0)};b.prototype.isNegative=function(){return!this.unsigned&&128===(this.bytes[n]&128)};b.prototype.isPositive=function(){return this.unsigned||0===(this.bytes[n]&128)};b.prototype.isEven=function(){return 0===(this.bytes[0]&1)};b.prototype.isOdd=function(){return 1===(this.bytes[0]&1)};b.prototype.isZero=function(){for(var a=0;a<e;++a)if(0!==this.bytes[a])return!1;return!0};b.prototype.compare=function(a){b.isIntN(a)||
(a=b.valueOf(a));var d=this.isNegative();if(d!==a.isNegative())return d?-1:1;for(d=n;0<=d;--d){if(this.bytes[d]<a.bytes[d])return-1;if(this.bytes[d]>a.bytes[d])return 1}return 0};b.prototype.equals=function(a){return 0===this.compare(a)};b.prototype.notEquals=function(a){return 0!==this.compare(a)};b.prototype.lessThan=function(a){return-1===this.compare(a)};b.prototype.lessThanEqual=function(a){return 0>=this.compare(a)};b.prototype.greaterThan=function(a){return 1===this.compare(a)};b.prototype.greaterThanEqual=
function(a){return 0<=this.compare(a)};b.fromInt=function(a,d){a|=0;var c;if(0>a)return-2147483648===a?b.MIN_VALUE:c=b.fromInt(-a,d).negate();c=s.slice(0,e);for(var f=0;f<e&&0!==a;++f)c[f]=a&255,a>>>=8;return c=new b(c,d)};b.prototype.toInt=function(a){a="boolean"===typeof a?a:this.unsigned;for(var b=this.isNegative(),c=b?this.not():this,f=0,g=Math.min(4,c.bytes.length),e=0;f<g;++f)e|=c.bytes[f]<<8*f;b&&(e=~e);return a?e>>>0:e};b.fromInts=function(a,d){for(var c=b.ZERO,f=0,g=Math.min(a.length,Math.ceil(e/
4)),l;f<g;++f)l=a[f],c=c.or((new b([l&255,l>>>8&255,l>>>16&255,l>>>24&255])).shiftLeft(32*f));return d?c.toUnsigned():c};b.prototype.toInts=function(){for(var a=Math.ceil(e/4),b=Array(a),c=0,f=0,g;c<a;f=4*++c){for(var l=g=0,k=Math.min(4,e-f);l<k;++l)g|=this.bytes[f+l]<<8*l;b[c]=g}return b};b.fromNumber=function(a,d){if("number"!==typeof a)throw TypeError("illegal arguments: "+typeof a);if(a!==a||!isFinite(a)||0===a)return d?b.UZERO:b.ZERO;if(0>a)return b.fromNumber(-a,d).negate();for(var c=0,f=Array(e);c<
e;++c)f[c]=a%256&255,a=Math.floor(a/256);return new b(f,d)};b.prototype.toNumber=function(){if(this.isNegative())return this.equals(b.MIN_VALUE)?-2147483648:-this.negate().toNumber();for(var a=0,d=0,c=Math.min(e,7);a<c;++a)d+=this.bytes[a]*t[a];return d};b.prototype.not=function(){for(var a=0,d=Array(e);a<e;++a)d[a]=~this.bytes[a];return new b(d,this.unsigned)};b.prototype.and=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var d=0,c=Array(e);d<e;++d)c[d]=this.bytes[d]&a.bytes[d];return new b(c,this.unsigned)};
b.prototype.or=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var d=0,c=Array(e);d<e;++d)c[d]=this.bytes[d]|a.bytes[d];return new b(c,this.unsigned)};b.prototype.xor=function(a){b.isIntN(a)||(a=b.valueOf(a));for(var d=0,c=Array(e);d<e;++d)c[d]=this.bytes[d]^a.bytes[d];return new b(c,this.unsigned)};b.prototype.shiftLeft=function(a){b.isIntN(a)&&(a=a.toInt());a%=m;if(0===a)return this;0>a&&(a+=m);var d=a/8|0;a%=8;for(var c=0,f=s.slice(0,e),g;c<e&&!((g=c+d)>=e);++c)f[g]|=this.bytes[c]<<a&255,++g<e&&
(f[g]|=this.bytes[c]<<a>>>8&255);return new b(f,this.unsigned)};b.prototype.shiftRight=function(a,d){b.isIntN(a)&&(a=a.toInt());a%=m;if(0===a)return this;0>a&&(a+=m);var c=a/8|0;a%=8;var f=s.slice(0,e),g;if(!d&&128===(this.bytes[n]&128)){var l;g=e-1;for(l=e-c-1;g>=l;--g)f[g]=255;f[++g]=f[g]<<7-a&255}var k;for(g=0;g<e;++g)0<=(k=g-c)&&(f[k]|=this.bytes[g]>>>a&255),0<=--k&&(f[k]|=this.bytes[g]<<8>>>a&255);return new b(f,this.unsigned)};b.prototype.shiftRightUnsigned=function(a){return this.shiftRight(a,
!0)};b.prototype.isSet=function(a){return(this.bytes[a/8|0]&(a=1<<a%8))===a};b.prototype.set=function(a,d){if(a>=m||this.isSet(a)==d)return this;var c=this.bytes.slice();c[a/8|0]=d?c[a/8|0]|1<<a%8:c[a/8|0]&255-(1<<a%8);return new b(c,this.unsigned)};b.prototype.size=function(){for(var a=n,b,c=1;0<=a;--a)if(0!==(b=this.bytes[a])){for(;b>>=1;)c++;return 8*a+c}return 0};b.add=function(a,b){for(var c=a.and(b),f=a.xor(b),g;!c.isZero();)g=c.shiftLeft(1),c=f.and(g),f=f.xor(g);return f};b.prototype.add=function(a){b.isIntN(a)||
(a=b.valueOf(a));return b.add(this,a)};b.prototype.negate=function(){return b.add(this.not(),b.ONE)};b.NEG_ONE=b.ONE.negate();b.subtract=function(a,d){return b.add(a,d.negate())};b.prototype.subtract=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.subtract(this,a)};b.prototype.absolute=function(){return this.unsigned?this:(this.isNegative()?this.negate():this).toUnsigned()};b.multiply=function(a,d){for(var c=a.unsigned?b.UZERO:b.ZERO,f=a.absolute(),g=d.absolute();!g.isZero();)1===(g.bytes[0]&1)&&
(c=b.add(c,f)),f=f.shiftLeft(1),g=g.shiftRight(1,!0);a.unsigned||a.isNegative()!==d.isNegative()&&(c=c.negate());return c};b.prototype.multiply=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.multiply(this,a)};b.divide=function(a,d){if(d.isZero())throw Error("division by zero");a.unsigned&&(d=d.toUnsigned());for(var c=a.absolute(),f=d.absolute(),g=b.UZERO,e=b.UZERO,k=c.size()-1;0<=k;--k)e=e.shiftLeft(1),e=e.set(0,c.isSet(k)),e.greaterThanEqual(f)&&(e=b.add(e,f.negate()),g=g.set(k,!0));a.unsigned||
(g=g.toSigned(),e=e.toSigned(),a.isNegative()!==d.isNegative()&&(g=g.negate()),a.isNegative()&&(e=e.negate()));return{quotient:g,remainder:e}};b.prototype.divide=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.divide(this,a).quotient};b.prototype.modulo=function(a){b.isIntN(a)||(a=b.valueOf(a));return b.divide(this,a).remainder};b.prototype.toDebug=function(a){for(var b=n,c,f="";0<=b;--b){for(c=this.bytes[b].toString(2);8>c.length;)c="0"+c;f+=c;a&&0<b&&(f+=" ")}this.unsigned&&(f+=a?" U":"U");return f};
var v=b.fromInt(2),w=b.fromInt(36);b.fromString=function(a,d,c){"number"===typeof d&&(c=d,d=!1);a=(a+"").toLowerCase();c=c||10;if(2>c||36<c)throw RangeError("radix out of range: "+c+" (2-36)");if("-"===a.charAt(0))return b.fromString(a.substring(1),d,c).negate();"+"===a.charAt(0)&&(a=a.substring(1));if("0"===a||"NaN"===a||"Infinity"===a)return d?b.UZERO:b.ZERO;d=d?b.UZERO:b.ZERO;for(var f=2===c?function(a){return 1<<a}:Math.pow.bind(Math,c),e=0,l=a.length,k,h;e<l;++e){k=a.charAt(l-e-1);h="0123456789abcdefghijklmnopqrstuvwxyz".indexOf(k);
if(0>h||h>c)throw Error("illegal interior character: "+k);d=b.add(d,b.multiply(b.fromInt(h),b.fromInt(f(e))))}return d};b.prototype.toString=function(a){a=a||10;b.isIntN(a)||(a=b.valueOf(a));if(a.lessThan(v)||a.greaterThan(w))throw RangeError("radix out of range: "+a.toInt()+" (2-36)");var d=this.unsigned?b.UZERO:b.ZERO;if(this.isNegative()){if(this.equals(b.MIN_VALUE)){var d=b.divide(this,a).quotient,c=b.add(b.multiply(d,a),this.negate());return d.toString(a)+c.toInt().toString(a.toInt())}return"-"+
this.negate().toString(a)}var c=this.toUnsigned(),f=[],e;do e=b.divide(c,a),f.unshift("0123456789abcdefghijklmnopqrstuvwxyz".charAt(e.remainder.toInt())),c=b.divide(c,a).quotient;while(!c.equals(d));return f.join("")};b["isInt"+m]=b.isIntN;for(var p in r)if(r.hasOwnProperty(p)){for(h=0;h<r[p].length;++h)b[p]&&(b[r[p][h]]=b[p]);for(h=0;h<r[p].length;++h)b.prototype[p]&&(b.prototype[r[p][h]]=b.prototype[p])}return q[m]=b}}();"undefined"!==typeof module&&module.exports?module.exports=q:"function"===
typeof define&&define.amd?define(function(){return q}):(t.dcodeIO=t.dcodeIO||{}).IntN=q})(this);
